
# Trading Bot

# **MT5 Automatic Trading System**

PlnÄ› automatickÃ½ systÃ©m pro trading pÅ™es MetaTrader 5 s Å™Ã­zenÃ­m rizika, high-impact news filtrem a Discord monitoringem.

---

## Funkce

* Multi-TF price-action systÃ©m: D1-H4-H1-M30-M5
* SR zÃ³ny, wick rejection, engulfing, FVG
* NY session only
* MT5 auto-execution
* Max trades/day, DD guard, spread filter
* Web scraping + MT5 calendar
* Discord kontrola, pÅ™Ã­kazy, restart
* Self-heal bezpeÄnostnÃ­ restart

---

## PoÅ¾adavky

| Komponenta | Verze         |
| ---------- | ------------- |
| OS         | Windows 10/11 |
| Python     | 3.10+         |
| MetaTrader | MT5           |

---

## Instalace

### **1. Instalace Pythonu**

* stÃ¡hni z python.org
* bÄ›hem instalace zaÅ¡krtni **Add to PATH**
* ovÄ›Å™enÃ­:

```
python --version
```

### **2. Instalace VSCode**

* stÃ¡hni z code.visualstudio.com
* extensions:

  * Python
  * Pylance

---
pip install -r requirements.txt                    nainstaluje knihovny

python -m pip freeze | % { $_.split('==')[0] } | % { python -m pip uninstall -y $_ }        odinstaluje vsechny knihovny

python -m pip cache purge                       odstrani cache a mezipamet po zbyvajicich knihovnach



### **3. Instalace MetaTrader 5**

#### StaÅ¾enÃ­

* z oficiÃ¡lnÃ­ch strÃ¡nek nebo vÃ½vojÃ¡Å™e brokera

#### PÅ™ihlÃ¡Å¡enÃ­

* zaloÅ¾ demo nebo reÃ¡lnÃ½ ÃºÄet
* zapni:

`Tools â†’ Options â†’ Expert Advisors â†’ Allow automated trading`

#### OvÄ›Å™ sÃ­Å¥

TerminÃ¡l MT5 musÃ­ bÃ½t spuÅ¡tÄ›nÃ½ **pÅ™ed botem**.

---

### **4. PÅ™idÃ¡nÃ­ symbolÅ¯**

OtevÅ™i MT5 â†’ Market Watch â†’ klik pravÃ½m:

`Symbols â†’ enable pÃ¡ry kterÃ© obchodujeÅ¡`

---

### **5. Git projekt / staÅ¾enÃ­ kÃ³du**

Extrahuj projekt do sloÅ¾ky:

```
C:\Users\Jiras\OneDrive\Plocha\ftmo          napriklad, kod si muzes umistit kamkoliv
```

---

### **6. Instalace Python knihoven**

V projektu spusÅ¥:

```
pip install -r requirements.txt
```

---

## .env konfigurace

vypln informace v .env

### NutnÃ© promÄ›nnÃ©

```
MT5_LOGIN=xxxx
MT5_PASSWORD=xxxx
MT5_SERVER=Broker-Server
SYMBOLS=EURUSD,GBPUSD,USDJPY
RISK_PER_TRADE=0.01
MAX_TRADES_PER_DAY=4
COMMENTS_DIR=./comments
NEWYORK_START=14:30
NEWYORK_END=21:00
SELF_RESTART=true
```

### Discord

```
DISCORD_BOT_TOKEN=
DISCORD_CHANNEL_ID=
BOT_OWNER_ID=
```

---

## VytvoÅ™enÃ­ bota
UdÄ›lenÃ­ oprÃ¡vnÄ›nÃ­ pro ÄtenÃ­/posÃ­lÃ¡nÃ­ zprÃ¡v a zÃ­skat token + channel ID.

1. VytvoÅ™enÃ­ aplikace a bota (Discord Developer Portal)
   1.1 OtevÅ™i: [https://discord.com/developers/applications](https://discord.com/developers/applications)
   1.2 Klikni â€New Applicationâ€œ. Dej nÃ¡zev. UloÅ¾.
   1.3 V levÃ©m menu zvol â€Botâ€œ. Klikni â€Add Botâ€œ â†’ â€Yes, do itâ€œ.
   1.4 Pod poloÅ¾kou Bot najdeÅ¡ â€TOKENâ€œ (Click to Reveal). **Token si uloÅ¾**.

   * Nikomu ho nedÃ¡vej. Pokud se token kompromituje, Regenerate.

2. PovolenÃ­ intents (dÅ¯leÅ¾itÃ©)
   2.1 Na tÃ©Å¾e strÃ¡nce Bot najdi sekci â€Privileged Gateway Intentsâ€œ.
   2.2 Zapni **Message Content Intent** (nutnÃ© pro ÄtenÃ­ obsahu pÅ™Ã­kazÅ¯).
   2.3 Pokud chceÅ¡ shromaÅ¾Äovat Äleny, zapni takÃ© Presence / Server Members podle potÅ™eby.
   2.4 Klikni Save Changes.

3. NastavenÃ­ oprÃ¡vnÄ›nÃ­ (OAuth2 invite)
   3.1 V levÃ©m menu otevÅ™i â€OAuth2â€œ â†’ â€URL Generatorâ€œ.
   3.2 V â€SCOPESâ€œ zaÅ¡krtni: **bot**, pÅ™Ã­padnÄ› **applications.commands** (pokud chceÅ¡ slash pÅ™Ã­kazy).
   3.3 V ÄÃ¡sti â€BOT PERMISSIONSâ€œ vyber pÅ™esnÄ›:

   * View Channels
   * Read Message History
   * Send Messages
   * Embed Links
   * Attach Files
   * Manage Messages (volitelnÄ›, pokud chceÅ¡ mazat zprÃ¡vy)
   * Add Reactions (volitelnÄ›)
   * Use External Emojis (volitelnÄ›)
     3.4 ZkopÃ­ruj vygenerovanÃ½ URL, otevÅ™i ho v prohlÃ­Å¾eÄi, vyber server a pÅ™idej bota.

PoznÃ¡mka: pokud nechceÅ¡ riskovat, pouÅ¾ij jen Body: View, Read, Send.

4. ZÃ­skÃ¡nÃ­ Channel ID (kam bude bot posÃ­lat)
   4.1 V Discord klientu jdi do User Settings â†’ Advanced â†’ zapni **Developer Mode**.
   4.2 PravÃ½m tlaÄÃ­tkem na kanÃ¡l â†’ â€Copy IDâ€œ. To je `DISCORD_CHANNEL_ID`.
   4.3 Pokud chceÅ¡ bot do vÃ­ce kanÃ¡lÅ¯, mÅ¯Å¾eÅ¡ pouÅ¾Ã­t vÃ­ce ID nebo nechat bot reagovat globÃ¡lnÄ›.

5. UloÅ¾enÃ­ do .env
   Do projektu vloÅ¾ / uprav `.env`:

```
DISCORD_TOKEN=tvuj_token_z_developer_portalu
DISCORD_CHANNEL_ID=123456789012345678

```
6. NastavenÃ­ v kÃ³du (ovÄ›Å™enÃ­ intentu)
   6.1 V kÃ³du pÅ™i tvorbÄ› bota musÃ­Å¡ povolit `message_content` intent:

```py
intents = discord.Intents.default()
intents.message_content = True
bot = commands.Bot(command_prefix="!", intents=intents)
```

6.2 Zajisti, Å¾e v Developer Portalu je Message Content Intent povolenÃ½. Jinak bot sice pobÄ›Å¾Ã­, ale pÅ™Ã­kazy neÄetl.

7. TestovÃ¡nÃ­ bota
   7.1 SpusÅ¥ `python discord_bot.py` nebo spuÅ¡tÄ›nÃ­ pÅ™es `main.py`.
   7.2 Na serveru napiÅ¡ `!myid`. Bot by mÄ›l odpovÄ›dÄ›t s tvÃ½m ID.
   7.3 NapiÅ¡ `!status`. Bot odeÅ¡le pÅ™ehled stavu.
   7.4 Pokud nedostaneÅ¡ odpovÄ›Ä:

* Zkontroluj token v `.env`.
* Zkontroluj, Å¾e bot mÃ¡ oprÃ¡vnÄ›nÃ­ posÃ­lat zprÃ¡vy v kanÃ¡lu.
* Zapni v DevPortalu Message Content Intent.
* Zkontroluj konzoli bota pro chyby.

8. DodateÄnÃ© bezpeÄnostnÃ­ a provoznÃ­ kroky
   8.1 Token nikdy neposÃ­lej veÅ™ejnÄ›. Pokud unikne, v Dev Portal zvol â€Regenerateâ€œ.
   8.2 Pro produkci dej bota do vlastnÃ­ho Discord serveru nebo jen omezenÃ©ho kanÃ¡lu.
   8.3 Pokud nasazujeÅ¡ na VPS, nastav systemd/tmux/screen aby bot bÄ›Å¾el non-stop.
   8.4 DoporuÄenÃ© logs: povolit logovÃ¡nÃ­ do souboru (mÃ¡Å¡ `logs/`) a rotovat.

9. Checklist pÅ™ed spuÅ¡tÄ›nÃ­m

* MT5 bÄ›Å¾Ã­ a je pÅ™ihlÃ¡Å¡enÃ½ do stejnÃ©ho ÃºÄtu jako v `.env` (MT5_LOGIN apod.).
* `.env` obsahuje `DISCORD_TOKEN` a `DISCORD_CHANNEL_ID`.
* Bot je pozvÃ¡n na server a mÃ¡ oprÃ¡vnÄ›nÃ­ pro danÃ½ kanÃ¡l.
* V Dev Portal povolen `Message Content Intent`.
* V kÃ³du intents nastaveny (`intents.message_content = True`).
* Logy fungujÃ­, pÅ™Ã­padnÃ© chyby kontroluj v `logs/discord_bot.log` nebo v konzoli.

---

KrÃ¡tkÃ½ troubleshooting:

* Bot online v Dev Portal ale nereaguje â†’ chybÃ­ Message Content Intent nebo chybnÃ© intents v kÃ³du.
* Bot nereaguje v konkrÃ©tnÃ­m kanÃ¡lu â†’ zkontroluj prÃ¡va kanÃ¡lu (Send Messages, View Channel).
* `Missing Permissions` v konzoli â†’ uprav role bota na serveru nebo pozvi znovu s vyÅ¡Å¡Ã­mi oprÃ¡vnÄ›nÃ­mi.
* Channel ID = 0 nebo prÃ¡zdnÃ© â†’ zkopÃ­ruj ID sprÃ¡vnÄ› (Developer Mode).

Pokud chceÅ¡, pÅ™idÃ¡m do README i pÅ™Ã­klad invite URL s doporuÄenÃ½mi permisemi a pÅ™esnÃ½ screenshot-by-screenshot prÅ¯vodce (popÃ­Å¡u textovÄ› nebo ti vygeneruji obrÃ¡zkovÃ© kroky). ChceÅ¡ to do README jako text nebo jako inline sekci se screenshoty?


## SpuÅ¡tÄ›nÃ­

```
python main.py
```

TerminÃ¡l/logs musÃ­ ukÃ¡zat:

```
MT5 initialized and logged in.
Trading loop started.
Starting Discord bot.
```

---

## Strategie â€” PÅ™ehled

### Timeframe logika

| TF     | ÃšÄel               |
| ------ | ------------------ |
| D1     | hlavnÃ­ trend       |
| H4     | swing bias         |
| H1/M30 | momentum potvrzenÃ­ |
| M5     | vstupnÃ­ trigger    |

### PodmÃ­nky vstupu

* Cena testuje validnÃ­ D1 S/R zÃ³nu
* ATR tolerance
* Min. poÄet dotykÅ¯ (D1+W)
* Bull/bear rejection nebo engulfing
* FVG detekce
* Higher TF potvrzenÃ­
* Spread OK
* Risk OK

### VÃ½poÄet risku

Lot size = fixnÃ­ procento equity a vzdÃ¡lenost SL.

---

## Discord pÅ™Ã­kazy

| PÅ™Ã­kaz         | Funkce                 |
| -------------- | ---------------------- |
| `!status`      | stav MT5, trading mode |
| `!balance`     | equity / balance       |
| `!performance` | winrate, RR            |
| `!calendar`    | nadchÃ¡zejÃ­cÃ­ news      |
| `!zones`       | SR graf                |
| `!log x`       | poslednÃ­ch x logÅ¯      |
| `!restart`     | restart robota         |
| `!tradingmode` | notify/live            |
| `!health  `    | aktualni vyuziti PC    |
| `!settings`    | zobrazÃ­ nastavenÃ­ bota |
| `!alerts`      | alerty o pohybu ceny   |


---

## Struktura projektu

```
ğŸ“ PROJECT_ROOT/
â”œâ”€â”€ ğŸ“ analysis/
â”‚   â”œâ”€â”€ mtf.py
â”‚   â”œâ”€â”€ volume.py
â”‚   â”œâ”€â”€ zones.py
â”‚   â””â”€â”€ entry.py
â”œâ”€â”€ ğŸ“ assets/
â”‚   â”œâ”€â”€ ğŸ“ backgrounds/
â”‚   â”œâ”€â”€ Montserrat-Bold.tlf
â”‚   â””â”€â”€README.md
â”œâ”€â”€ ğŸ“ backtest/
â”œâ”€â”€ ğŸ“ comments/
â”‚   â”œâ”€â”€ takeprofit.txt
â”‚   â”œâ”€â”€ stoploss.txt
â”‚   â”œâ”€â”€ motivation.txt
â”‚   â”œâ”€â”€ buy.txt
â”‚   â””â”€â”€ sell.txt
â”œâ”€â”€ ğŸ“ features/
â”‚   â”œâ”€â”€ ğŸ“ gamesy/
â”‚   â”œâ”€â”€ ğŸ“ env/ kalkulacky
â”‚   â”œâ”€â”€ barvy.html
â”‚   â”œâ”€â”€ cas.py
â”‚   â”œâ”€â”€ csv-data.py
â”‚   â”œâ”€â”€ diag.py
â”‚   â”œâ”€â”€ kalkulacka.py
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ stats.py (nepouzivano/nefunkcni)
â”‚   â””â”€â”€ test.py  (nepouzivano/nefunkcni)
â”œâ”€â”€ ğŸ“ logs/
â”œâ”€â”€ ğŸ“ strategy/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ swing_strategy.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ ğŸ“ env/
â”œâ”€â”€ comments.py
â”œâ”€â”€ config.py
â”œâ”€â”€ data.py
â”œâ”€â”€ discord_bot.py
â”œâ”€â”€ executor.py
â”œâ”€â”€ image_generator.py
â”œâ”€â”€ logger.py
â”œâ”€â”€ main.py
â”œâ”€â”€ metrics.py
â”œâ”€â”€ monitoring.py
â”œâ”€â”€ notifications.py
â”œâ”€â”€ position_watcher.py
â”œâ”€â”€ README.MD
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ risk.py
â”œâ”€â”€ trade.py
â”œâ”€â”€ utils.py
â””â”€â”€ watchdog.py
```

---

## TypickÃ½ flow

1. Bot naÄte price data z MT5
2. Analyzuje D1-H4-H1-M30-M5
3. Identifikuje S/R zone touch
4. Test reversalu a continuation
5. VÃ½poÄet lot size
6. Spread check
7. Risk gates
8. Vstup nebo skip
9. Å˜Ã­zenÃ­ pozice
10. Update logÅ¯ a Discordu

---

## Debug a testy

### Test MT5 pÅ™ipojenÃ­

```
python -c "import metatrader5 as mt5; print(mt5.initialize())"
```

### Test knihoven

```
pip install --force-reinstall -r requirements.txt
```

---

## NejÄastÄ›jÅ¡Ã­ chyby

| ProblÃ©m               | Å˜eÅ¡enÃ­                                         |
| --------------------- | ---------------------------------------------- |
| Bot nepÅ™ipojen k MT5  | Å¡patnÃ© pÅ™ihlÃ¡Å¡enÃ­ nebo MT5 nenÃ­ spuÅ¡tÄ›n        |
| Neobchoduje           | mimo session, spread, news filter, Å¾Ã¡dnÃ½ setup |
| Discord bot nereaguje | Å¡patnÃ½ token / chybÃ­ permissions               |
| Pouze signÃ¡ly         | NOTIFY_ONLY=true                               |
| MT5 dÄ›lÃ¡ zvukovÃ© signÃ¡ly        | vypni zvuky MetaTraderu, jsou normÃ¡lnÃ­         |

---

## FAQ

**Q: Funguje na funded acc?**
Ano. StavÄ›no pro trading vÅ¡eobecnÄ›, pouze upravit .env.

**Q: UmÃ­ hedging?**
Ne. StandardnÃ­ one-position risk model.

**Q: ProÄ Å¾Ã¡dnÃ© obchody?**
Ne kaÅ¾dÃ½ den je validnÃ­ confluence. To je zÃ¡mÄ›r.

**Q: MÅ¯Å¾u pÅ™idat dalÅ¡Ã­ pÃ¡ry?**
Ano, Ãºprava `.env â†’ SYMBOLS`.

---

## BezpeÄnostnÃ­ zÃ¡sady

* nepouÅ¾Ã­vat martingale
* nepouÅ¾Ã­vat na ÃºÄtu bez SL
* testovat 2â€“4 tÃ½dny


---

## Licence

Pouze pro osobnÃ­ vÃ½zkum a vÃ½uku.

